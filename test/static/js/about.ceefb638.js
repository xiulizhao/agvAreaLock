"use strict";(self["webpackChunktde_web"]=self["webpackChunktde_web"]||[]).push([[443],{6705:function(a,e,s){s.r(e),s.d(e,{default:function(){return h}});var t=function(){var a=this,e=a._self._c;return e("div",{staticClass:"about"},[e("Heads",{attrs:{pageBtn:a.pageBtn}}),e("div",{ref:"img_box",staticClass:"img_box",style:{width:a.fullWidth+"px"}}),e("canvas",{ref:"juxing",staticClass:"cavasBg",attrs:{width:"400",height:"400"},on:{click:function(e){return a.canvasDown(e)},touchstart:function(e){return a.canvasDown(e)}}}),e("div",{attrs:{to:"body"}},[e("modal",{attrs:{show:a.showModal},on:{close:function(e){a.showModal=!1},touchstart:function(e){a.showModal=!1}},scopedSlots:a._u([{key:"body",fn:function(){return[e("p",{staticClass:"dialogdes"},[a._v("区域标识:"),e("span",{staticClass:"agvNameNumber"},[a._v(a._s(a.info))])]),e("div",{staticClass:"dialogdes"},[a._v("占用AGV:"),a._l(a.infoCarList,(function(s,t){return e("button",{key:t,staticClass:"agvNameNumberbtn"},[a._v(a._s(s.agvName))])}))],2),e("p",{staticClass:"dialogdes"},[a._v("备注:"),e("span",{staticClass:"agvNameNumber"},[a._v(a._s(a.des))])])]},proxy:!0}])})],1)],1)},o=[],r=(s(7658),s(8827)),i=s(4148),n=(s.p,s.p,{name:"about",components:{Heads:r.Z,Modal:i.Z},data(){return{showModal:!1,fullWidth:document.documentElement.clientWidth,fullHeight:document.documentElement.clientHeight,pageBtn:"切换列表模式",dataJson:"",clickXY:[],mapData:"",newFiltered:[],infoCarList:[],info:"",des:"",areaMarkArr:[],Terminal:""}},mounted(){this.handleResize()},methods:{handleResize(){this.fullWidth=document.documentElement.clientWidth,this.fullHeight=document.documentElement.clientHeight,console.log(this.fullWidth),setTimeout((()=>{var a=function(){var a=navigator.userAgent,e=/(?:Windows Phone)/.test(a),s=/(?:SymbianOS)/.test(a)||e,t=/(?:Android)/.test(a),o=/(?:Firefox)/.test(a),r=(/(?:Chrome|CriOS)/.test(a),/(?:iPad|PlayBook)/.test(a)||t&&!/(?:Mobile)/.test(a)||o&&/(?:Tablet)/.test(a)),i=/(?:iPhone)/.test(a)&&!r,n=!i&&!t&&!s;return{isTablet:r,isPhone:i,isAndroid:t,isPc:n}}();if(a.isAndroid||a.isPhone)console.log("手机");else if(a.isTablet){console.log("平板");let a="平板";this.$data.Terminal=a,this.map()}else if(a.isPc){console.log("PC");let a="PC";this.$data.Terminal=a,this.map()}}),50)},map(){this.$data.dataJson=JSON.parse(this.$route.query.msgData),this.$data.mapData=JSON.parse(this.$route.query.mapData);this.$refs.img_box;const a=this.$refs["img_box"].offsetWidth,e=this.$refs["img_box"].offsetHeight;let s=this,t=s.$refs.juxing;console.log(t);let o=t.getContext("2d");t.width=a,t.height=e,o.translate(0,e),o.rotate(1*Math.PI),o.scale(-1,1),o.fillStyle="red";let r=[{areaMark:"cross_BNG1_1",x:"820",y:"120",w:"40",h:"80"},{areaMark:"cross_BHV2_2",x:"840",y:"240",w:"20",h:"80"},{areaMark:"cross_Dhv2_2",x:"680",y:"360",w:"20",h:"73"},{areaMark:"cross_BHV2_1",x:"820",y:"240",w:"20",h:"80"},{areaMark:"cross_BNG9_2",x:"820",y:"50",w:"20",h:"60"},{areaMark:"cross_BNG9_1",x:"840",y:"50",w:"20",h:"60"},{areaMark:"cross_BNG3Rd",x:"810",y:"435",w:"80",h:"40"},{areaMark:"cross_BNG3_2",x:"840",y:"495",w:"20",h:"90"},{areaMark:"cross_BNG3_1",x:"820",y:"495",w:"20",h:"90"},{areaMark:"cross_BNG8_2",x:"820",y:"630",w:"20",h:"80"},{areaMark:"cross_BNG8_1",x:"840",y:"710",w:"20",h:"80"},{areaMark:"cross_schjB_2",x:"680",y:"650",w:"20",h:"80"},{areaMark:"cross_schjB_1",x:"660",y:"650",w:"20",h:"80"},{areaMark:"cross_schjC_2",x:"680",y:"580",w:"20",h:"70"},{areaMark:"cross_schjC_1",x:"660",y:"580",w:"20",h:"70"},{areaMark:"cross_NG3B_2",x:"680",y:"490",w:"20",h:"40"},{areaMark:"cross_NG3A",x:"680",y:"530",w:"20",h:"50"},{areaMark:"cross_NG3Rd",x:"640",y:"435",w:"85",h:"40"},{areaMark:"cross_BNG4_2",x:"840",y:"335",w:"20",h:"70"},{areaMark:"cross_ju4Rd",x:"480",y:"435",w:"85",h:"40"},{areaMark:"cross_ju4A_2",x:"515",y:"360",w:"20",h:"70"},{areaMark:"cross_ju4A_1",x:"490",y:"360",w:"20",h:"70"},{areaMark:"cross_ju4B_2",x:"515",y:"290",w:"20",h:"70"},{areaMark:"cross_NG3B_1",x:"660",y:"360",w:"20",h:"73"},{areaMark:"cross_ju4schj_1",x:"660",y:"255",w:"20",h:"73"},{areaMark:"cross_ju4schj_2",x:"680",y:"255",w:"20",h:"100"},{areaMark:"cross_schjA_2",x:"660",y:"735",w:"20",h:"70"},{areaMark:"cross_schjA_1",x:"680",y:"735",w:"20",h:"70"},{areaMark:"cross_A198",x:"805",y:"808",w:"85",h:"40"},{areaMark:"cross_hcRd",x:"635",y:"808",w:"85",h:"40"},{areaMark:"cross_jinzi1",x:"470",y:"808",w:"85",h:"40"},{areaMark:"cross_A1_1",x:"490",y:"765",w:"20",h:"40"},{areaMark:"cross_A1_2",x:"515",y:"765",w:"20",h:"40"},{areaMark:"cross_jinzi_1",x:"515",y:"700",w:"20",h:"60"},{areaMark:"cross_jinzi3_2",x:"515",y:"55",w:"20",h:"70"},{areaMark:"cross_jinzi_2",x:"515",y:"635",w:"20",h:"60"},{areaMark:"cross_ju3A_1",x:"490",y:"700",w:"20",h:"60"},{areaMark:"cross_ju3A_2",x:"515",y:"580",w:"20",h:"50"},{areaMark:"cross_ju3B_1",x:"490",y:"525",w:"20",h:"50"},{areaMark:"cross_ju3B_2",x:"515",y:"525",w:"20",h:"50"},{areaMark:"cross_A2_1",x:"490",y:"580",w:"20",h:"50"},{areaMark:"cross_A2_2",x:"490",y:"635",w:"20",h:"60"}],i=[],n={};if(r.forEach((a=>{n={areaMark:a.areaMark},i.push(n)})),this.$data.areaMarkArr=i,void 0!==this.dataJson){const a=this.dataJson.map((a=>a.areaMark));let e=r.filter((e=>a.includes(e.areaMark)));this.mapData.forEach((a=>{e.forEach(((e,s)=>{a.areaMark==e.areaMark&&(e.areaAgvList=a.areaAgvList,e.des=a.des)}))})),this.$data.newFiltered=e;for(let s=0;s<e.length;s++)this.areaMarkArr.forEach((a=>{if(e[s].areaMark==a.areaMark){let a=e[s].x,t=e[s].y,r=e[s].areaMark,i=e[s].areaAgvList,n=e[s].des,l=e[s].w,d=e[s].h;o.strokeStyle="#d01b1b","PC"==this.Terminal?(o.lineWidth=4,o.rect(Number(a),Number(t),Number(l),Number(d)),o.stroke(),this.clickXY.push({x:Number(a),y:Number(t),w:Number(l),h:Number(d),info:r,infoCarList:i,des:n})):"平板"==this.Terminal&&(o.lineWidth=3,o.rect(Number(a/2.5),Number(1.1*t),Number(l/2),Number(d)),o.stroke(),this.clickXY.push({x:Number(a/2.5),y:Number(1.1*t),w:Number(l/2),h:Number(d),info:r,infoCarList:i,des:n}))}}))}},canvasDown(a){console.log("按下",a);let e=this,s=e.$refs.juxing,t=s.getContext("2d");t.translate(0,s.height),t.rotate(1*Math.PI),t.scale(-1,1);const o=s.getBoundingClientRect();console.log("rect",o);const r=Math.abs(a.clientX-o.left),i=Math.abs(a.clientY-o.bottom);for(let n of this.clickXY)if(r>=n.x&&r<=n.x+n.w&&i>=n.y&&i<=n.y+n.h){this.showModal=!0,console.log("区域名称"+n.info,n.infoCarList),this.$data.info=n.info,console.log("区域小车列表",n.infoCarList),this.$data.infoCarList=n.infoCarList,this.$data.des=n.des;break}},canvasMove(a){console.log("移动")},canvasUp(a){console.log("抬起")}},created(){window.addEventListener("resize",this.handleResize)},beforeUnmount(){window.removeEventListener("resize",this.handleResize)}}),l=n,d=s(1001),c=(0,d.Z)(l,t,o,!1,null,null,null),h=c.exports},8444:function(a,e,s){s.r(e),s.d(e,{default:function(){return k}});var t=function(){var a=this,e=a._self._c;return e("div",{staticClass:"unlock"},[e("Heads"),e("div",{staticClass:"main"},[a._l(a.newdataJson,(function(s,t){return e("div",{key:t,ref:"moduleList",refInFor:!0,staticClass:"moduleList"},[e("div",{staticClass:"areaListUl"},[e("div",{staticClass:"areaList"},[a._v("区域标识:")]),e("div",{staticClass:"areaList"},[a._v("占用AGV:")]),e("div",{staticClass:"areaList"},[a._v("备注:")]),e("button",{staticClass:"releaseBtn",attrs:{agvName:s.agvName,areaMark:s.areaMark},on:{click:function(e){return a.release(e)}}},[a._v("强制释放")])]),e("div",{ref:"data_alue",refInFor:!0,staticClass:"data_alue"},[e("div",{staticClass:"areaList1 areaList3",attrs:{title:s.areaMark},on:{click:function(e){a.showModal=!0,a.addLikes(e)}}},[a._v(" "+a._s(s.areaMark))]),e("div",{staticClass:"areaList1 area"},[a._v(a._s(s.agvName))]),e("div",{ref:"remark",refInFor:!0,staticClass:"areaList1 areaList2",attrs:{title:s.des},on:{click:function(e){a.showModal=!0,a.addLikes(e)}}},[a._v(a._s(s.des))])]),e("div",{staticStyle:{clear:"both"}})])})),e("div",{staticClass:"Modals hide"},[e("div",{staticClass:"Modalslist1"},[a._v("是否强制释放通行锁？")]),e("div",{staticClass:"Modalslist1"},[a._v(" 区域标识:"),e("span",{staticClass:"agvNameNumber dialogdes"},[a._v(a._s(a.areaMark))])]),e("div",{staticClass:"Modalslist"},[a._v(" 占用AGV:"),e("span",{staticClass:"agvNameNumber dialogdes"},[a._v(a._s(a.agvName))])]),e("div",{staticClass:"ModalslistBtn"},[e("button",{staticClass:"clearBtn releaseBtn3",attrs:{agvName:this.agvName,areaMark:this.areaMark},on:{click:function(e){a.cancel(e),a.getUnlock(e)}}},[a._v("确定")]),e("button",{staticClass:"closeBtn releaseBtn4",on:{click:function(e){return a.cancel(e)}}},[a._v("取消")])])]),e("div",{staticClass:"md-overlay hide"}),e("div",{attrs:{to:"body"}},[e("modal",{attrs:{show:a.showModal},on:{close:function(e){a.showModal=!1}},scopedSlots:a._u([{key:"body",fn:function(){return[e("span",{staticClass:"dialogdes"},[a._v(a._s(a.DesJson))])]},proxy:!0}])})],1)],2),e("div",[a._v(a._s(a.city))])],1)},o=[],r=(s(7658),s(9436),s(8827)),i=s(142),n=s(4148),l=(s(8155),s(8051)),d=(s(4471),{name:"unlock",components:{Heads:r.Z,tdeIndex:i.Z,Modal:n.Z},data(){return{newdataJson:[],showModal:!1,aaa:"",bbb:"",newDes:[],DesJson:"",fullWidth:document.documentElement.clientWidth,fullHeight:document.documentElement.clientHeight,agvName:"",areaMark:"",dataJson:[],path:"ws://192.168.3.250:12345/netserver/1",sockernum:0,socket:"",newcar:[],newAdddataJson:[],firstDataJson:[{areaMark:"cross_spk22Rd",des:"哈哈哈",areaAgvList:[{agvName:"我是新加入的"}]}]}},mounted(){this.ceshi(),setTimeout((()=>{var a=function(){var a=navigator.userAgent,e=/(?:Windows Phone)/.test(a),s=/(?:SymbianOS)/.test(a)||e,t=/(?:Android)/.test(a),o=/(?:Firefox)/.test(a),r=(/(?:Chrome|CriOS)/.test(a),/(?:iPad|PlayBook)/.test(a)||t&&!/(?:Mobile)/.test(a)||o&&/(?:Tablet)/.test(a)),i=/(?:iPhone)/.test(a)&&!r,n=!i&&!t&&!s;return{isTablet:r,isPhone:i,isAndroid:t,isPc:n}}();if(a.isAndroid||a.isPhone)console.log("手机");else if(a.isTablet){console.log("平板");var e=this,s=e.$refs.moduleList,t=e.$refs.data_alue,o=e.$refs.remark;console.log(o);for(var r=0;r<s.length;r++){var i=s[r];i.style.width="327px"}for(r=0;r<t.length;r++){var n=t[r];n.style.width="200px"}for(r=0;r<o.length;r++){var l=o[r];console.log(l)}}else a.isPc&&console.log("PC")}),10)},methods:{init(){this.items=[{id:1,name:"Item 1",areaAgvList:[{agvName:"C0021"},{agvName:"C0022"}]},{id:2,name:"Item 2",areaAgvList:[{agvName:"C0021"},{agvName:"C0022"}]},{id:3,name:"Item 3",areaAgvList:[{agvName:"C0021"},{agvName:"C0022"}]}],this.additionalItems=[{operatetype:"asklock",agvid:"3",zoneid:"Item 1"},{operatetype:"asklock",agvid:"3111",zoneid:"Item 2"}],this.items.forEach((a=>{var e={};this.additionalItems.forEach((s=>{var t=a.name,o=a.areaAgvList;console.log(t);var r=s.zoneid;console.log(r),-1!=t.indexOf(r)&&(e={agvName:s.agvid},o.push(e))}))})),console.log(this.items),console.log("测试",this.items),console.log("测试1",this.additionalItems);var a=[{areaMark:"cross_spk111Rd",des:"spk靠近十字路口123123spk靠近十字路口123123spk靠近十字路口123123spk靠近十字路口123123spk靠近十字路口123123spk靠近十字路口123123spk靠近十字路口123123spk靠近十字路口123123spk靠近十字路口123123spk靠近十字路口123123spk靠近十字路口123123spk靠近十字路口123123spk靠近十字路口123123spk靠近十字路口123123spk靠近十字路口123123spk靠近十字路口123123spk靠近十字路口123123spk靠近十字路口123123spk靠近十字路口123123spk靠近十字路口123123",areaAgvList:[{agvName:"C001"},{agvName:"C0011121"}]},{areaMark:"cross_spk22Rd",des:"spk靠近pd丁子路口",areaAgvList:[{agvName:"C0021"},{agvName:"C0022"}]},{areaMark:"cross_spk33Rd",des:"spk靠近pdspk靠近十字路口123123spk靠近十字路口123123spk靠近十字路口123123spk靠近十字路口123123spk靠近十字路口123123spk靠近十字路口123123",areaAgvList:[{agvName:"C0031"},{agvName:"C0032"}]},{areaMark:"cross_spk4444Rd",des:"spk靠近pdspk靠近十字路口123123spk靠近十字路口123123",areaAgvList:[{agvName:"C004"},{agvName:"C0041"},{agvName:"C0041"}]},{areaMark:"cross_spk33Rd",des:"spk靠近pdspk靠近十字路口123123spk靠近十字路口123123spk靠近十字路口123123spk靠近十字路口123123spk靠近十字路口123123spk靠近十字路口123123",areaAgvList:[{agvName:"C0031"},{agvName:"C0032"}]},{areaMark:"cross_spk4444Rd",des:"spk靠近pdspk靠近十字路口123123spk靠近十字路口123123",areaAgvList:[{agvName:"C004"},{agvName:"C0041"},{agvName:"C0041"}]}];this.$data.newdataJson=a},ceshi(){if("WebSocket"in window){console.log("您的浏览器支持WebSocket");var a=[{operatetype:"asklock",agvid:"我是新加入的333哈哈哈",zoneid:"cross_spk33Rd",des:"哈哈哈"}][{operatetype:"asklock",agvid:"我是新加入的333哈哈哈",zoneid:"cross_spk33Rd",des:"哈哈哈"}][{operatetype:"releaselock",agvid:"B001",zoneid:"B区",des:"重庆路口"}][{operatetype:"asklock",agvid:"B001",zoneid:"B区",des:"重庆路口"}][{operatetype:"asklock",agvid:"C003",zoneid:"A区",des:"spk靠近pdspk靠3"}][{areaMark:"A区",des:"spk靠近pdspk靠3",areaAgvList:[{agvName:"C001"},{agvName:"C002"}]}];console.log(a);var e=[],s=[];if(""!=a)for(var t=0;t<a.length;t++)if(a[t].hasOwnProperty("operatetype"))if(console.log("该值存在"),"asklock"==a[t].operatetype)if(console.log("收到增加锁的信息"),this.$data.newcar=a,""!=this.firstDataJson)this.firstDataJson.forEach((a=>{var e={};this.newcar.forEach((s=>{var t=a.areaMark,o=a.areaAgvList,r=s.zoneid;if(-1!=t.indexOf(r))e={agvName:s.agvid},o.push(e);else{console.log("this.newcar",this.newcar);const a=this.newcar.reduce(((a,e)=>{const s=a.find((a=>a.areaMark===e.zoneid));return s?s.areaAgvList.push({agvName:e.agvid}):a.push({areaMark:e.zoneid,des:e.des,areaAgvList:[{agvName:e.agvid}]}),a}),[]);a.forEach((a=>{this.$data.firstDataJson.push(a),console.log("Item",a),console.log(this.firstDataJson)}))}}))})),console.log("收到数据新增",this.firstDataJson),this.$data.newAdddataJson=this.firstDataJson,this.newAdddataJson.forEach((a=>{let t=a.areaMark,o=a.des,r=a.areaAgvList,i={},n={};for(let l=0;l<r.length;l++){let a=r[l].agvName;i={areaMark:t,des:o,agvName:a},e.push(i),n={des:o},s.push(n),this.$data.newdataJson=e,this.$data.newDes=s}}));else{console.log("走了整体数据为空值的时候添加了新锁");var o={},r=[];for(let e=0;e<a.length;e++){o={areaMark:a[e].zoneid,des:a[e].des,agvName:a[e].agvid},r.push(o),this.$data.newdataJson=r,console.log("123",this.newdataJson);const s=a.reduce(((a,e)=>{const s=a.find((a=>a.areaMark===e.zoneid));return s?s.areaAgvList.push({agvName:e.agvid}):a.push({areaMark:e.zoneid,des:e.des,areaAgvList:[{agvName:e.agvid}]}),a}),[]);console.log("结果",s),this.$data.firstDataJson=s,console.log(this.firstDataJson)}}else if(1==a[t].operatetype){console.log("申请删除解锁成功");let e=this.newdataJson.filter((e=>!a.some((a=>a.agvid===e.agvName))));console.log("申请删除解锁成功返回所有的数据",e),this.$data.newdataJson=e}else if(2==a[t].operatetype)console.log("解锁失败");else{console.log("收到服务端自己删除锁的信息");let e=this.newdataJson.filter((e=>!a.some((a=>a.agvid===e.agvName))));console.log("收到服务端自己删除锁剩下所有的数据",e),this.$data.newdataJson=e}else{console.log("该值不存在"),this.$data.firstDataJson=a;for(var i=a[t].areaMark,n=a[t].des,l=a[t].areaAgvList,d={},c={},h=0;h<l.length;h++){var g=l[h].agvName;d={areaMark:i,des:n,agvName:g},e.push(d),c={des:n},s.push(c),this.$data.newdataJson=e,this.$data.newDes=s}}else console.log("没有数据")}else console.log("您的浏览器不支持websocket")},getUnlock(a){console.log("数据返回成功");const e=a.currentTarget.getAttributeNode("agvName").value,s=a.currentTarget.getAttributeNode("areaMark").value;console.log(e),console.log(s);var t={areaName:e,areaMark:s};l.Z.getIndexList(t).then((a=>{console.log("IndexList",a),console.log(a.data)})).catch((a=>{console.log(a)}))},getData(){axios.get("/query?name=tom").then((function(a){console.log(a),200==result.status?sonsole.log("数据返回成功"):console.log("数据返回错误")})).catch((function(a){console.log(a)}))},addLikes(a){console.log(a),console.log(a.srcElement.innerHTML),this.$data.DesJson=a.srcElement.innerHTML},release(a){let e=document.querySelector(".Modals"),s=document.querySelector(".md-overlay");s.classList.remove("hide"),e.classList.remove("hide"),this.$data.agvName=a.currentTarget.getAttributeNode("agvName").value,this.$data.areaMark=a.currentTarget.getAttributeNode("areaMark").value},cancel(a){let e=document.querySelector(".Modals"),s=document.querySelector(".md-overlay");s.classList.add("hide"),e.classList.add("hide"),console.log(a)}},computed:{city(){return this.$store.state.fid}}}),c=d,h=s(1001),g=(0,h.Z)(c,t,o,!1,null,null,null),k=g.exports}}]);